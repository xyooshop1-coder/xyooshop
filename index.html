<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Grow a Garden Pets – Store</title>
  <style>
    :root{
      --brand:#6fbf73;
      --brand-dark:#57a85c;
      --bg:#f4f9f4;
      --ink:#222;
      --muted:#666;
      --card:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background:var(--bg); color:var(--ink);
    }
    header{
      background:var(--brand); color:#fff; padding:2rem 1rem; text-align:center;
    }
    header h1{margin:0; font-size:clamp(1.6rem,3.5vw,2.4rem)}
    header p{margin:.25rem 0 0; opacity:.9}
    .container{max-width:1100px; margin:0 auto; padding:1.5rem}

    /* Catalog */
    .toolbar{display:flex; gap:1rem; align-items:center; justify-content:space-between; margin:1rem 0 1.25rem}
    .toolbar .search{flex:1}
    .toolbar input[type="text"]{width:100%; padding:.75rem 1rem; border-radius:10px; border:1px solid #d9e4da; background:#fff}

    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:1rem}
    .card{background:var(--card); border:1px solid #e5eee6; border-radius:16px; overflow:hidden; display:flex; flex-direction:column; box-shadow:0 6px 16px rgba(0,0,0,.06)}
    .card img{width:100%; height:180px; object-fit:cover; background:#eaf3eb}
    .card .body{padding:1rem; display:flex; flex-direction:column; gap:.5rem; flex:1}
    .name{font-weight:700}
    .desc{font-size:.9rem; color:var(--muted); line-height:1.35}
    .priceRow{display:flex; align-items:center; gap:.5rem; margin-top:auto}
    .price{font-weight:800}
    .strike{color:#999; text-decoration:line-through; font-weight:600}
    .badge{display:inline-block; background:#f5fdf5; color:#1a7f2e; border:1px solid #cfe8d3; padding:.2rem .5rem; font-size:.75rem; border-radius:999px}
    .out{background:#fff6f6; color:#a33; border-color:#efcaca}
    .actions{display:flex; gap:.5rem; margin-top:.75rem}
    button, .btn{
      appearance:none; border:none; border-radius:12px; padding:.7rem 1rem; font-weight:700; cursor:pointer; background:var(--brand); color:#fff; transition:.15s transform ease, .15s background ease;
    }
    button.secondary{background:#eaf3eb; color:#17421f}
    button:disabled{opacity:.55; cursor:not-allowed}
    button:hover{background:var(--brand-dark)}

    /* Cart */
    .cart{position:sticky; top:0; align-self:flex-start; background:#fff; border:1px solid #e5eee6; border-radius:16px; padding:1rem; box-shadow:0 8px 18px rgba(0,0,0,.06)}
    .layout{display:grid; grid-template-columns:1fr; gap:1.25rem}
    @media (min-width: 980px){ .layout{ grid-template-columns: 2fr 1fr; } }

    .cart h3{margin:.25rem 0 1rem}
    .cartList{display:flex; flex-direction:column; gap:.75rem; max-height:55vh; overflow:auto; padding-right:.4rem}
    .line{display:grid; grid-template-columns: 56px 1fr auto; gap:.6rem; align-items:center}
    .line img{width:56px; height:56px; object-fit:cover; border-radius:10px; background:#eaf3eb}
    .line .meta{display:flex; flex-direction:column}
    .line .meta .muted{font-size:.8rem; color:var(--muted)}
    .qty{display:flex; align-items:center; gap:.5rem}
    .qty input{width:64px; padding:.4rem .5rem; border-radius:8px; border:1px solid #d7e4d8}
    .remove{background:#f6f6f6; color:#333}

    .summary{border-top:1px dashed #e3eee5; margin-top:1rem; padding-top:1rem; display:flex; flex-direction:column; gap:.5rem; font-size:.95rem}
    .summary .row{display:flex; justify-content:space-between}
    .summary .total{font-size:1.1rem; font-weight:900}

    .coupon{display:flex; gap:.5rem; margin-top:.5rem}
    .coupon input{flex:1; padding:.6rem .75rem; border:1px solid #d7e4d8; border-radius:10px}

    footer{margin-top:2rem; text-align:center; padding:1rem; color:#507152}
  </style>
</head>
<body>
  <header>
    <h1>Grow a Garden Pets – Store</h1>
    <p>Adopt, Grow, and Love Your Digital Garden Pets!</p>
  </header>

  <div class="container layout">
    <main>
      <div class="toolbar">
        <div class="search"><input id="search" type="text" placeholder="Search pets, seeds, accessories…"></div>
        <span id="catalogCount" class="badge"></span>
      </div>
      <div id="catalog" class="grid"></div>
    </main>

    <aside class="cart">
      <h3>Your Cart</h3>
      <div id="cartList" class="cartList"></div>

      <div class="coupon">
        <input id="couponCode" placeholder="Coupon code (e.g. GARDEN10)">
        <button class="secondary" onclick="applyCoupon()">Apply</button>
      </div>

      <div class="summary">
        <div class="row"><span>Subtotal</span><span id="subtotal">$0.00</span></div>
        <div class="row"><span>Discount</span><span id="discount">-$0.00</span></div>
        <div class="row total"><span>Total</span><span id="total">$0.00</span></div>
        <button id="checkoutBtn" onclick="checkout()" disabled>Checkout with PayPal</button>
      </div>
    </aside>
  </div>

  <footer>&copy; 2025 Grow a Garden Pets. All rights reserved.</footer>

  <script>
    /**
     * 👉 EDIT THESE SETTINGS
     */
    const SETTINGS = {
      CURRENCY: 'USD',
      PAYPAL_BUSINESS: 'YOUR-PAYPAL-EMAIL@example.com', // ← replace with your PayPal email
      DEFAULT_COUPON: null, // e.g. 'GARDEN10'
    };

    /**
     * 👉 PRODUCTS (edit/add/remove items here)
     * stock = 0 will show "Out of Stock" and disable the Add button on the product card
     * salePrice (optional): if present and lower than price, it will be shown and used for totals
     */
    const PRODUCTS = [
      {
        id: 'starter-pet',
        name: 'Starter Garden Pet',
        desc: 'Watch your first virtual garden pet grow and evolve in your digital garden.',
        price: 29.99,
        salePrice: 24.99, // put null if not on sale
        stock: 20,
        image: 'Kitsune29.webp', // put your image file path here
        sku: 'GAP-001'
      },
      {
        id: 'sprout-buddy',
        name: 'Sprout Buddy',
        desc: 'A cheerful sprout companion that reacts to your care.',
        price: 14.99,
        salePrice: null,
        stock: 0, // out of stock example
        image: 'images/sprout.jpg',
        sku: 'GAP-002'
      },
      {
        id: 'mystic-seed-pack',
        name: 'Mystic Seed Pack',
        desc: 'A pack of rare digital seeds with surprise evolutions.',
        price: 9.99,
        salePrice: 7.99,
        stock: 50,
        image: 'images/seeds.jpg',
        sku: 'GAP-003'
      }
    ];

    /**
     * 👉 OPTIONAL: coupon codes (percentage discounts)
     * key = code (uppercase), value = percent (0.10 = 10%)
     */
    const COUPONS = {
      'GARDEN10': 0.10,
      'PLANT20': 0.20,
    };

    // --- Store state ---
    let state = {
      cart: {}, // id -> { id, qty }
      coupon: SETTINGS.DEFAULT_COUPON,
      search: ''
    };

    // Helpers
    const fmt = (n) => new Intl.NumberFormat('en-US', { style:'currency', currency: SETTINGS.CURRENCY }).format(n);
    const getProduct = (id) => PRODUCTS.find(p => p.id === id);
    const unitPrice = (p) => (p.salePrice && p.salePrice < p.price) ? p.salePrice : p.price;

    // Render catalog
    function renderCatalog(){
      const list = document.getElementById('catalog');
      const search = state.search.trim().toLowerCase();
      const filtered = PRODUCTS.filter(p =>
        p.name.toLowerCase().includes(search) ||
        p.desc.toLowerCase().includes(search) ||
        (p.sku||'').toLowerCase().includes(search)
      );
      document.getElementById('catalogCount').textContent = `${filtered.length} item${filtered.length!==1?'s':''}`;

      list.innerHTML = filtered.map(p => {
        const priceHtml = (p.salePrice && p.salePrice < p.price)
          ? `<span class="strike">${fmt(p.price)}</span> <span class="price">${fmt(p.salePrice)}</span> <span class="badge">Sale</span>`
          : `<span class="price">${fmt(p.price)}</span>`;
        const out = p.stock <= 0;
        return `
          <article class="card">
            <img src="${p.image}" alt="${p.name}">
            <div class="body">
              <div class="name">${p.name}</div>
              <div class="desc">${p.desc}</div>
              <div class="priceRow">${priceHtml}</div>
              <div class="actions">
                <button ${out? 'disabled' : ''} onclick="addToCart('${p.id}')">${out? 'Out of Stock' : 'Add to Cart'}</button>
                ${out? '<span class="badge out">Out</span>' : `<span class="badge">${p.stock} in stock</span>`}
              </div>
            </div>
          </article>
        `;
      }).join('');
    }

    // Render cart
    function renderCart(){
      const box = document.getElementById('cartList');
      const items = Object.values(state.cart).map(line => ({...line, product: getProduct(line.id)})).filter(l => l.product);

      if(items.length === 0){
        box.innerHTML = '<div class="desc">Your cart is empty.</div>';
        document.getElementById('subtotal').textContent = fmt(0);
        document.getElementById('discount').textContent = '-' + fmt(0).replace('$','');
        document.getElementById('total').textContent = fmt(0);
        document.getElementById('checkoutBtn').disabled = true;
        return;
      }

      box.innerHTML = items.map(({id, qty, product:p}) => {
        const max = Math.max(0, p.stock);
        const price = unitPrice(p);
        return `
          <div class="line">
            <img src="${p.image}" alt="${p.name}">
            <div class="meta">
              <strong>${p.name}</strong>
              <span class="muted">${fmt(price)} each</span>
              <div class="qty">
                <label for="qty-${id}" class="muted">Qty</label>
                <input id="qty-${id}" type="number" min="1" max="${max||99}" value="${qty}" onchange="updateQty('${id}', this.value)">
                <button class="remove" onclick="removeFromCart('${id}')">Remove</button>
              </div>
            </div>
            <div><strong>${fmt(price * qty)}</strong></div>
          </div>
        `;
      }).join('');

      const sub = items.reduce((sum, l) => sum + unitPrice(l.product) * l.qty, 0);

      let discountPct = 0;
      if(state.coupon){
        const key = String(state.coupon).trim().toUpperCase();
        discountPct = COUPONS[key] || 0;
      }
      const discount = +(sub * discountPct).toFixed(2);
      const total = Math.max(0, sub - discount);

      document.getElementById('subtotal').textContent = fmt(sub);
      document.getElementById('discount').textContent = '-' + fmt(discount).replace('$','');
      document.getElementById('total').textContent = fmt(total);
      document.getElementById('checkoutBtn').disabled = total <= 0 || !SETTINGS.PAYPAL_BUSINESS || SETTINGS.PAYPAL_BUSINESS.includes('kizashikiall@gmail.com');
    }

    // Cart ops
    function addToCart(id){
      const p = getProduct(id); if(!p) return;
      if(p.stock <= 0){ alert('Sorry, this item is out of stock.'); return; }
      const line = state.cart[id] || { id, qty: 0 };
      const nextQty = Math.min((line.qty||0) + 1, p.stock || 99);
      state.cart[id] = { id, qty: nextQty };
      renderCart();
    }
    function removeFromCart(id){ delete state.cart[id]; renderCart(); }
    function updateQty(id, value){
      const qty = Math.max(1, parseInt(value || 1, 10));
      const p = getProduct(id); if(!p) return;
      state.cart[id] = { id, qty: Math.min(qty, p.stock || 99) };
      renderCart();
    }

    // Search
    document.getElementById('search').addEventListener('input', (e)=>{
      state.search = e.target.value; renderCatalog();
    });

    // Coupon
    function applyCoupon(){
      const code = document.getElementById('couponCode').value.trim().toUpperCase();
      if(!code){ state.coupon = null; renderCart(); return; }
      if(COUPONS[code]){ state.coupon = code; renderCart(); }
      else { alert('Invalid coupon'); }
    }

    // Checkout via PayPal (multi-item cart)
    function checkout(){
      const items = Object.values(state.cart).map(l => ({...l, product: getProduct(l.id)})).filter(l => l.product);
      if(items.length === 0) return;

      // Calculate totals
      const subtotal = items.reduce((s, l) => s + unitPrice(l.product) * l.qty, 0);
      let discountPct = 0;
      if(state.coupon){
        const key = String(state.coupon).trim().toUpperCase();
        discountPct = COUPONS[key] || 0;
      }
      const discount = +(subtotal * discountPct).toFixed(2);

      // Distribute discount across items so PayPal line items match the total
      const lines = [];
      let remainingDiscount = discount;
      let remainingSubtotal = subtotal;

      items.forEach((l, idx) => {
        const unit = unitPrice(l.product);
        const lineSubtotal = unit * l.qty;
        let lineDiscount = 0;
        if(discount > 0){
          if(idx === items.length - 1){
            // put whatever discount remains to avoid rounding errors
            lineDiscount = remainingDiscount;
          } else {
            const share = lineSubtotal / remainingSubtotal;
            lineDiscount = +(discount * share).toFixed(2);
            remainingDiscount -= lineDiscount;
            remainingSubtotal -= lineSubtotal;
          }
        }
        const effectiveLineSubtotal = Math.max(0, +(lineSubtotal - lineDiscount).toFixed(2));
        const effectiveUnit = +(effectiveLineSubtotal / l.qty).toFixed(2);
        lines.push({ name: l.product.name, qty: l.qty, unit: effectiveUnit });
      });

      // Create a form for classic PayPal cart checkout
      const form = document.createElement('form');
      form.method = 'post';
      form.target = '_blank';
      form.action = 'https://www.paypal.com/cgi-bin/webscr';

      const add = (n,v)=>{ const i=document.createElement('input'); i.type='hidden'; i.name=n; i.value=v; form.appendChild(i); };
      add('cmd','_cart');
      add('upload','1');
      add('business', SETTINGS.PAYPAL_BUSINESS);
      add('currency_code', SETTINGS.CURRENCY);

      lines.forEach((ln, idx) => {
        const i = idx + 1;
        add(`item_name_${i}`, ln.name);
        add(`amount_${i}`, ln.unit.toFixed(2));
        add(`quantity_${i}`, ln.qty);
      });

      // Optional: branding
      add('no_shipping','1'); // no shipping address required (digital goods)
      add('rm','2'); // return method

      document.body.appendChild(form);
      form.submit();
      document.body.removeChild(form);
    }

    // Init
    renderCatalog();
    renderCart();
    if(SETTINGS.DEFAULT_COUPON){
      document.getElementById('couponCode').value = SETTINGS.DEFAULT_COUPON;
      applyCoupon();
    }
  </script>
</body>
</html>
