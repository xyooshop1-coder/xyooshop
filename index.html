<!-- =========================
File: index.html (Public Storefront)
Host on GitHub Pages. Connects to Firestore. Uses PayPal.Me for payment.
========================= -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grow a Garden Pets – Store</title>
  <style>
    :root{ --brand:#6fbf73; --brand2:#57a85c; --bg:#f4f9f4; --ink:#1e2b22; --muted:#6a7b6d; --card:#fff }
    *{box-sizing:border-box} body{margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial; background:var(--bg); color:var(--ink)}
    header{background:var(--brand); color:#fff; padding:1.75rem 1rem; text-align:center}
    header h1{margin:0; font-size:clamp(1.4rem,3.5vw,2.2rem)} .sub{opacity:.9}
    .container{max-width:1100px; margin:0 auto; padding:1rem}
    .toolbar{display:flex; gap:.6rem; align-items:center; margin:1rem 0}
    .toolbar input{flex:1; padding:.7rem .9rem; border:1px solid #dfe8e1; border-radius:12px; background:#fff}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:1rem}
    .card{background:var(--card); border:1px solid #e5eee6; border-radius:16px; overflow:hidden; display:flex; flex-direction:column; box-shadow:0 6px 16px rgba(0,0,0,.06)}
    .card img{width:100%; height:180px; object-fit:cover; background:#eaf3eb}
    .body{padding:1rem; display:flex; flex-direction:column; gap:.5rem; flex:1}
    .name{font-weight:750}
    .desc{font-size:.92rem; color:var(--muted); line-height:1.35}
    .priceRow{display:flex; align-items:center; gap:.5rem; margin-top:auto}
    .price{font-weight:800} .strike{text-decoration:line-through; color:#9aa7a0; font-weight:600}
    .badge{display:inline-block; background:#f5fdf5; color:#1a7f2e; border:1px solid #cfe8d3; padding:.2rem .5rem; font-size:.73rem; border-radius:999px}
    .out{background:#fff6f6; color:#a33; border-color:#efcaca}
    .actions{display:flex; gap:.5rem; margin-top:.75rem; align-items:center}
    .qty{width:70px; padding:.45rem .5rem; border-radius:10px; border:1px solid #dfe8e1}
    .btn{appearance:none; border:none; border-radius:12px; padding:.6rem .9rem; font-weight:700; cursor:pointer; background:#0070ba; color:#fff}
    .btn:hover{background:#005ea6}
    .note{margin-top:.35rem; font-size:.82rem; color:#834}
    footer{padding:1rem; text-align:center; color:var(--muted)}
    .banner{background:#fff7cc; border:1px solid #ffe58a; color:#5c4a00; border-radius:12px; padding:.6rem .8rem; margin:1rem 0}
  </style>
</head>
<body>
  <header>
    <h1>Grow a Garden Pets – Store</h1>
    <p class="sub">Adopt, Grow, and Love Your Digital Garden Pets!</p>
  </header>

  <div class="container">
    <div class="banner">
      <strong>Payment tip:</strong> After clicking Pay, select <em>Friends and Family</em> so the money won't be put on hold. Please <strong>always send a receipt</strong>.
    </div>

    <div class="toolbar">
      <input id="search" type="text" placeholder="Search pets, seeds, accessories…" />
      <a href="login.html" class="btn" style="background:#eaf3eb; color:#184822">Admin</a>
    </div>

    <section id="catalog" class="grid"></section>
  </div>

  <footer>© 2025 Grow a Garden Pets</footer>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import { getFirestore, collection, query, orderBy, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

    // Firebase config (your real values)
    const firebaseConfig = {
      apiKey: "AIzaSyDQXDOxP_XSt8PWux2ipaKXQG_EzxE9W48",
      authDomain: "xyoo-shop.firebaseapp.com",
      projectId: "xyoo-shop",
      storageBucket: "xyoo-shop.firebasestorage.app",
      messagingSenderId: "671592025442",
      appId: "1:671592025442:web:a8795522a2ae9762b2b03b",
      measurementId: "G-8TJXH0ZJVZ"
    };

    const PAYPAL_ME = 'JhonJoross'; // Your PayPal.Me username
    const CURRENCY = 'USD';

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const catalogEl = document.getElementById('catalog');
    const searchEl = document.getElementById('search');

    const fmt = (n)=> new Intl.NumberFormat('en-US', { style:'currency', currency:CURRENCY }).format(n);

    function unitPrice(p){ return (p.salePrice && p.salePrice < p.price) ? p.salePrice : p.price; }

    function render(products){
      const q = (searchEl.value||'').toLowerCase();
      const docs = products.filter(p=> p.active !== false)
        .filter(p=> !q || (p.name||'').toLowerCase().includes(q) || (p.desc||'').toLowerCase().includes(q));

      catalogEl.innerHTML = docs.map(p=>{
        const out = (p.stock||0) <= 0;
        const priceHTML = (p.salePrice && p.salePrice < p.price)
          ? `<span class="strike">${fmt(p.price)}</span> <span class="price">${fmt(p.salePrice)}</span> <span class="badge">Sale</span>`
          : `<span class="price">${fmt(p.price)}</span>`;
        const price = unitPrice(p) || 0;
        const pid = p.id;
        return `
          <article class="card">
            <img src="${p.imageURL||''}" alt="${p.name||''}">
            <div class="body">
              <div class="name">${p.name||''}</div>
              <div class="desc">${p.desc||''}</div>
              <div class="priceRow">${priceHTML}</div>
              <div class="actions">
                <label class="muted">Qty</label>
                <input id="qty-${pid}" class="qty" type="number" min="1" max="${p.stock||1}" value="1" ${out? 'disabled':''}>
                <button class="btn" ${out? 'disabled':''} onclick="(function(){
                  const q = Math.max(1, Math.min(parseInt(document.getElementById('qty-${pid}').value)||1, ${p.stock||1}));
                  const total = ((${price}) * q).toFixed(2);
                  const href = `https://www.paypal.me/${PAYPAL_ME}/${'${'}total${'}'}${CURRENCY==='USD'?'USD':''}`;
                  window.open(href,'_blank');
                })()">Pay with PayPal</button>
                ${out? '<span class="badge out">Out of Stock</span>' : `<span class="badge">${p.stock||0} in stock</span>`}
              </div>
              <div class="note">Please select <strong>Friends and Family</strong> at PayPal and <strong>send receipt</strong>.</div>
            </div>
          </article>`
      }).join('');
    }

    // Live products feed
    const qProducts = query(collection(db,'products'), orderBy('name'));
    onSnapshot(qProducts, snap => {
      const items = snap.docs.map(d=> ({ id:d.id, ...d.data() }));
      render(items);
    });

    searchEl.addEventListener('input', ()=>{
      // re-render with the cached items from the last snapshot if needed
    });
  </script>
</body>
</html>


<!-- =========================
File: login.html (Admin Login)
========================= -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Login – Grow a Garden Pets</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial; background:#f4f9f4; margin:0}
    .wrap{max-width:380px; margin:8vh auto; background:#fff; border:1px solid #e5eee6; border-radius:16px; padding:1rem 1.2rem; box-shadow:0 8px 18px rgba(0,0,0,.06)}
    h1{font-size:1.25rem}
    input{width:100%; padding:.7rem .8rem; border:1px solid #dfe8e1; border-radius:10px; margin:.4rem 0}
    button{width:100%; padding:.7rem; border:none; border-radius:12px; background:#6fbf73; color:#fff; font-weight:700; cursor:pointer}
    button:hover{background:#57a85c}
    .note{color:#6a7b6d; font-size:.9rem; margin-top:.5rem}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Admin Login</h1>
    <form id="loginForm">
      <input type="email" id="email" placeholder="Email" required>
      <input type="password" id="password" placeholder="Password" required>
      <button type="submit">Sign In</button>
      <div class="note">Only the store owner can access the admin panel.</div>
    </form>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import { getAuth, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDQXDOxP_XSt8PWux2ipaKXQG_EzxE9W48",
      authDomain: "xyoo-shop.firebaseapp.com",
      projectId: "xyoo-shop",
      storageBucket: "xyoo-shop.firebasestorage.app",
      messagingSenderId: "671592025442",
      appId: "1:671592025442:web:a8795522a2ae9762b2b03b",
      measurementId: "G-8TJXH0ZJVZ"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    document.getElementById('loginForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      try{
        await signInWithEmailAndPassword(auth, email, password);
        window.location.href = 'admin.html';
      }catch(e){ alert(e.message); }
    });
  </script>
</body>
</html>


<!-- =========================
File: admin.html (Admin Panel – protected by UID)
========================= -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Panel – Grow a Garden Pets</title>
  <style>
    :root{ --brand:#6fbf73; --brand2:#57a85c; --bg:#f4f9f4; --ink:#1e2b22; --muted:#6a7b6d; --card:#fff }
    *{box-sizing:border-box} body{margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial; background:var(--bg); color:var(--ink)}
    header{background:var(--brand); color:#fff; padding:1rem 1.2rem; display:flex; align-items:center; justify-content:space-between}
    .container{max-width:1100px; margin:0 auto; padding:1rem}
    .admin{background:#fff; border:1px solid #e5eee6; border-radius:16px; padding:1rem; box-shadow:0 8px 18px rgba(0,0,0,.06)}
    .row{display:flex; flex-wrap:wrap; gap:.6rem; margin:.4rem 0}
    input, textarea, select{padding:.6rem .7rem; border:1px solid #dfe8e1; border-radius:10px}
    .table{width:100%; border-collapse:collapse; margin-top:.75rem}
    .table th,.table td{padding:.6rem .5rem; border-bottom:1px dashed #e7efe8; text-align:left; font-size:.92rem}
    .table img{width:44px; height:44px; object-fit:cover; border-radius:8px}
    .btn{appearance:none; border:none; border-radius:12px; padding:.6rem .9rem; font-weight:700; cursor:pointer; background:#6fbf73; color:#fff}
    .btn:hover{background:#57a85c} .secondary{background:#eaf3eb; color:#184822} .danger{background:#e45d5d}
  </style>
</head>
<body>
  <header>
    <div><strong>Admin Panel</strong></div>
    <div>
      <a href="index.html" class="secondary btn">Back to Store</a>
      <button id="logout" class="btn" style="margin-left:.4rem">Sign Out</button>
    </div>
  </header>

  <div class="container">
    <section class="admin">
      <h3>Add / Edit Product</h3>
      <div class="row">
        <input id="pId" placeholder="id (auto for new)" />
        <input id="pName" placeholder="Name" />
        <input id="pPrice" placeholder="Price" type="number" step="0.01" />
        <input id="pSale" placeholder="Sale price (optional)" type="number" step="0.01" />
        <input id="pStock" placeholder="Stock" type="number" />
        <select id="pActive"><option value="true">Active</option><option value="false">Hidden</option></select>
      </div>
      <textarea id="pDesc" rows="3" placeholder="Description" style="width:100%"></textarea>
      <div class="row">
        <input id="pSku" placeholder="SKU (optional)" />
        <input id="pImgUrl" placeholder="Image URL (auto from upload)" style="flex:1" />
        <input id="pImg" type="file" accept="image/*" />
        <button id="saveBtn" class="btn">Save Product</button>
        <button id="resetBtn" class="secondary btn">Reset</button>
      </div>

      <table class="table" id="adminTable">
        <thead><tr><th>Img</th><th>Name</th><th>Price</th><th>Sale</th><th>Stock</th><th>Status</th><th>Actions</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js';
    import { getFirestore, collection, addDoc, setDoc, deleteDoc, doc, getDocs, serverTimestamp, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';
    import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDQXDOxP_XSt8PWux2ipaKXQG_EzxE9W48",
      authDomain: "xyoo-shop.firebaseapp.com",
      projectId: "xyoo-shop",
      storageBucket: "xyoo-shop.firebasestorage.app",
      messagingSenderId: "671592025442",
      appId: "1:671592025442:web:a8795522a2ae9762b2b03b",
      measurementId: "G-8TJXH0ZJVZ"
    };

    const ADMIN_UID = 'jQ3rMulWTJWrjdkIEVEIPpKD9nQ2'; // only this Firebase Auth user can access admin

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    onAuthStateChanged(auth, (user)=>{
      if(!user || user.uid !== ADMIN_UID){
        // Not allowed → go back to store
        window.location.replace('index.html');
      }
    });

    // UI refs
    const tbody = document.querySelector('#adminTable tbody');
    const pId = document.getElementById('pId');
    const pName = document.getElementById('pName');
    const pDesc = document.getElementById('pDesc');
    const pPrice = document.getElementById('pPrice');
    const pSale = document.getElementById('pSale');
    const pStock = document.getElementById('pStock');
    const pSku = document.getElementById('pSku');
    const pImgUrl = document.getElementById('pImgUrl');
    const pImg = document.getElementById('pImg');
    const pActive = document.getElementById('pActive');

    document.getElementById('logout').addEventListener('click', ()=> signOut(auth).then(()=>window.location='index.html'));
    document.getElementById('resetBtn').addEventListener('click', ()=> resetForm());
    document.getElementById('saveBtn').addEventListener('click', saveProduct);
    pImg.addEventListener('change', handleImageUpload);

    async function handleImageUpload(e){
      const file = e.target.files[0]; if(!file) return;
      const key = `products/${Date.now()}_${file.name}`;
      const r = ref(storage, key);
      await uploadBytes(r, file);
      const url = await getDownloadURL(r);
      pImgUrl.value = url;
      alert('Image uploaded. URL filled.');
    }

    function resetForm(){
      [pId,pName,pDesc,pPrice,pSale,pStock,pSku,pImgUrl].forEach(el=> el.value='');
      pActive.value='true'; pImg.value='';
    }

    async function saveProduct(){
      const data = {
        name: pName.value.trim(),
        desc: pDesc.value.trim(),
        price: parseFloat(pPrice.value||0),
        salePrice: pSale.value? parseFloat(pSale.value): null,
        stock: parseInt(pStock.value||0),
        sku: pSku.value.trim() || null,
        imageURL: pImgUrl.value.trim() || '',
        active: pActive.value === 'true',
        updatedAt: serverTimestamp()
      };
      try{
        if(pId.value){ await setDoc(doc(db,'products',pId.value), data, { merge:true }); }
        else { const d = await addDoc(collection(db,'products'), data); pId.value = d.id; }
        alert('Saved.');
        loadProducts();
      }catch(e){ alert(e.message); }
    }

    async function loadProducts(){
      const qy = query(collection(db,'products'), orderBy('updatedAt','desc'));
      const snap = await getDocs(qy);
      const rows = [];
      snap.forEach(docSnap=>{
        const p = {id:docSnap.id, ...docSnap.data()};
        rows.push(`<tr>
          <td><img src="${p.imageURL||''}" alt=""></td>
          <td>${p.name||''}<div style="color:#6a7b6d; font-size:.85rem">${p.sku||''}</div></td>
          <td>${p.price!=null? p.price.toFixed(2):''}</td>
          <td>${p.salePrice!=null? p.salePrice.toFixed(2):'-'}</td>
          <td>${p.stock ?? 0}</td>
          <td>${p.active===false? 'Hidden':'Active'}</td>
          <td>
            <button class="secondary btn" onclick='(${editRow})(JSON.parse(this.dataset.p))' data-p='${JSON.stringify(p).replace(/"/g,'&quot;')}' >Edit</button>
            <button class="danger btn" onclick="(${delRow})('${p.id}')">Delete</button>
          </td>
        </tr>`);
      });
      tbody.innerHTML = rows.join('');
    }

    function editRow(p){
      pId.value = p.id; pName.value = p.name||''; pDesc.value = p.desc||'';
      pPrice.value = p.price ?? ''; pSale.value = p.salePrice ?? '';
      pStock.value = p.stock ?? 0; pSku.value = p.sku || '';
      pImgUrl.value = p.imageURL || ''; pActive.value = String(p.active !== false);
      window.scrollTo({top:0, behavior:'smooth'});
    }

    async function delRow(id){
      if(!confirm('Delete this product?')) return;
      await deleteDoc(doc(db,'products',id));
      loadProducts();
    }

    // expose helpers for inline handlers
    window.editRow = editRow; window.delRow = delRow;

    loadProducts();
  </script>
</body>
</html>


<!-- =========================
FIRESTORE & STORAGE SECURITY RULES (set in Firebase Console > Build > Firestore/Storage > Rules)
Replace ADMIN_UID with your UID. These prevent anyone else from writing data via your frontend.
========================= -->
<!--
rules_version = '2';
service cloud.firestore {
  match /databases/{db}/documents {
    match /products/{id} {
      allow read: if true;                       // public can read
      allow write: if request.auth != null &&    // only signed-in
                   request.auth.uid == 'jQ3rMulWTJWrjdkIEVEIPpKD9nQ2'; // your admin UID
    }
  }
}

service firebase.storage {
  match /b/{bucket}/o {
    match /products/{allPaths=**} {
      allow read: if true;                       // public can view images
      allow write: if request.auth != null && request.auth.uid == 'jQ3rMulWTJWrjdkIEVEIPpKD9nQ2';
    }
  }
}
-->
